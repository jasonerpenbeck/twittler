<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link rel="stylesheet" href="twittler.css">
  </head>
  <body>



    <script>

      // Initialize an array of month names: need this for basic date formatting
      var monthNames = ["January","February","March","April","May","June","July","August","September","October","November","December"];
      // Initialize username for single-user mode
      var username;

      // function that formats date in the basic Month Day, Year configuration
      function basicDate (date) {
        return monthNames[date.getMonth()] + " " + date.getDate() + ", " + date.getFullYear();
      }

      // function that makes link building easier
      function link(url,text) {
        return ['<a href=',url,'>',text,'</a>'].join('');
      }

      function div(contains,divClass,divID) {

        var classInDiv = divClass ? "class = " + divClass: '';
        var idInDiv = divID ? "id = " + divID: '';

        return '<div ' + classInDiv + ' ' +  idInDiv + '>' + contains + '</div>';
      }

      // function that builds div structure of each tweet
      function formatTweet(user,message,date) {

       return [
       '<div class="tweetContainer" id="',
          user,
          '">',
          div(div(link('#','@' + user),"tweetUser",user) + div(date,"tweetTime"),"tweetTopLine"),
          div(message,"tweetBottomLine"),
        '</div>'].join('');
      }


     function displayTweets() {

        //var singleUser = arguments.length > 0 ? arguments[0] : false;
        var singleUser = arguments[0] || false;

        var $body = $('body');
        $body.html('');

        // limit the total number of displayed tweets to 25
        var index = (singleUser) ? streams.users[singleUser].length-1 : streams.home.length - 1;

        while(index >= 0){

          var tweet = (singleUser) ? streams.users[singleUser][index] : streams.home[index];
          var $tweet = $(formatTweet(tweet.user,tweet.message,basicDate(tweet.created_at)));
          $tweet.appendTo($body);
          index -= 1;
        }

        // format every other tweet as border-less
        $('.tweetContainer:even').css({'border':'0px white solid','background': 'white'});

     }

      // show tweets once the document is ready and every two seconds after
      $(document).ready(function() {
        setInterval(displayTweets(username),2000);


        $('.tweetContainer').click(function(event) {
          username = $(this).attr('id');
          setInterval(displayTweets(username),2000);

        });


       });

    </script>
  </body>
</html>
